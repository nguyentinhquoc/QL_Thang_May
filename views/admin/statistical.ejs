<%- include('../layout/header') %>
  <style>
    .tHead {
      color: white;
      background-color: rgb(61, 205, 61);
      font-weight: 900;
      border: 3px solid;
    }
  </style>
  <div class="card p-4">
    <h4>Thống kê công trình</h4>
    <div class="d-flex justify-content-end mb-3">
      <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-sm btn-primary" onclick="printOnlyTable()"><i class="fas fa-print"></i> In bảng</button>
      </div>
      <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-sm btn-warning" onclick="window.location.href='statistical/export'">Xuất bảng</button>
      </div>
    </div>

    <div class="tab-pane preview-tab-pane active" role="tabpanel"
      aria-labelledby="tab-dom-da4be276-f13c-47d6-be82-655bc6452fd5" id="dom-da4be276-f13c-47d6-be82-655bc6452fd5">
      <div id="tableExample3" data-list='{"valueNames":["stt","noiDung","soLuong"],"page":200,"pagination":true}'>
        <div class="row justify-content-end g-0">
          <div class="col-auto col-sm-5 mb-3">
            
          </div>
        </div>
        <div class="table-responsive scrollbar">
          <table class="table table-bordered table-hover table-striped fs-10 mb-0">
            <thead class="bg-200">
              <tr>
                <th class="text-900 sort" data-sort="stt">STT</th>
                <th class="text-900 sort" data-sort="noiDung">Nội dung</th>
                <th class="text-900 sort" data-sort="soLuong">Số lượng</th>
              </tr>
            </thead>
            <tbody class="list">
              <tr class="tHead">
                <td style="color: white;">1</td>
                <td style="color: white;">Tổng số lượng thang máy trong thời gian bảo hành</td>
                <td style="color: white;">
                  <%= statisticalWarranty.tong %>
                </td>
              </tr>
              <tr>
                <td>1.1</td>
                <td> <a href="/project/maintenance/Hà Nội">Hà Nội</a> </td>
                <td>
                  <%= statisticalWarranty.haNoi %>
                </td>
              </tr>
              <tr>
                <td>1.2</td>
                <td> <a href="/project/maintenance/Quảng Ninh">Quảng Ninh</a> </td>
                <td>
                  <%= statisticalWarranty.quangNinh %>
                </td>
              </tr>
              <tr>
                <td>1.3</td>
                <td> <a href="/project/maintenance/Tỉnh thành khác">Khác</a> </td>
                <td>
                  <%= statisticalWarranty.khac %>
                </td>
              </tr>
              <!-- ============= -->
              <tr class="tHead">
                <td style="color: white;">2</td>
                <td style="color: white;">Tổng số lượng thang máy trong thời gian bảo trì có thu phí</td>
                <td style="color: white;">
                  <%= statisticalMaintenanceFree.tong %>
                </td>
              </tr>
              <tr>
                <td>2.1</td>
                <td> <a href="/project/maintenance/Hà Nội">Hà Nội</a> </td>
                <td>
                  <%= statisticalMaintenanceFree.haNoi %>
                </td>
              </tr>
              <tr>
                <td>2.2</td>
                <td> <a href="/project/maintenance/Quảng Ninh">Quảng Ninh</a> </td>
                <td>
                  <%= statisticalMaintenanceFree.quangNinh %>
                </td>
              </tr>
              <tr>
                <td>2.3</td>
                <td> <a href="/project/maintenance/Tỉnh thành khác">Khác</a> </td>
                <td>
                  <%= statisticalMaintenanceFree.khac %>
                </td>
              </tr>
              <!-- ========== -->
              <tr class="tHead">
                <td style="color: white;">3</td>
                <td style="color: white;">Tổng số lượng thang máy trong thời gian bảo trì không thu phí</td>
                <td style="color: white;">
                  <%= statisticalMaintenance.tong %>
                </td>
              </tr>
              <tr>
                <td>3.1</td>
                <td> <a href="/project/maintenance/Hà Nội">Hà Nội</a> </td>
                <td>
                  <%= statisticalMaintenance.haNoi %>
                </td>
              </tr>
              <tr>
                <td>3.2</td>
                <td> <a href="/project/maintenance/Quảng Ninh">Quảng Ninh</a> </td>
                <td>
                  <%= statisticalMaintenance.quangNinh %>
                </td>
              </tr>
              <tr>
                <td>3.3</td>
                <td> <a href="/project/maintenance/Tỉnh thành khác">Khác</a> </td>

                <td>
                  <%= statisticalMaintenanceFree.khac %>
                </td>
              </tr>
              <!-- ========== -->
            </tbody>
          </table>
        </div>
        <div class="d-flex justify-content-center mt-3">
          <button class="btn btn-sm btn-falcon-default me-1" type="button" title="Previous" data-list-pagination="prev">
            <span class="fas fa-chevron-left"></span>
          </button>
          <ul class="pagination mb-0"></ul>
          <button class="btn btn-sm btn-falcon-default ms-1" type="button" title="Next" data-list-pagination="next">
            <span class="fas fa-chevron-right"> </span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- script in -->
  <script>
    function printOnlyTable() {
      const table = document.querySelector('#tableExample3 table'); // Lấy phần <table>
      const win = window.open('', '', 'height=800,width=1000');
      win.document.write('<html><head><title>Thống kê công trình</title>');
      win.document.write('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">');
      win.document.write('<style>table { font-size: 12px; } th, td { padding: 6px; }</style>');
      win.document.write('<style>.tHead { font-size: 13px; color:black; background-color:none; } </style>');
      win.document.write('</head><body>');
      win.document.write(table.outerHTML); // Chỉ in nội dung bảng
      win.document.write('</body></html>');
      win.document.close();
      win.focus();
      win.print();
      // win.close();
    }
  </script>

  <%- include('../layout/footer') %>
